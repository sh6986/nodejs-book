# 몽고디비

# NoSQL vs SQL

## NoSQL

- MySQL같은 SQL 데이터베이스와는 다른 유형의 데이터
    - 대표적으로 mongoDB 사용
- SQL과 NoSQL의 비교
    - SQL(MySQL)
        - 규칙에 맞는 데이터 입력
        - 테이블 간 JOIN 지원
        - 안정성, 일관성
        - 용어(테이블, 로우, 컬럼)
    - NoSQL(몽고디비)
        - 자유로운 데이터 입력
        - 컬렉션 간 JOIN 미지원
        - 확장성, 가용성
        - 용어(컬렉션, 다큐먼트, 필드)
- JOIN: 관계가 있는 테이블끼리 데이터를 합치는 기능(몽고디비 aggregate로 흉내 가능)
- 빅데이터, 메시징, 세션 관리 등(비정형 데이터)에는 몽고디비 사용하면 좋음

# CRUD 작업하기

## Create

- 몽고디비는 컬럼을 정의하지 않아도 됨
    - 자유로움이 장점, 무엇이 들어올지 모른다는 단점
    - 자바스크립트의 자료형을 따름(차이점도 존재)
    - ObjectId: 몽고디비의 자료형으로 고유 아이디 역할을 함
    - save method로 저장

## Create(관계 설정)

- 컬렉션 간 관계를 강요하는 제한이 없으므로 직접 ObjectId를 넣어 연결
    - 사용자의 ObjectId를 찾은 뒤 댓글 컬렉션에 넣음

## Read

- find로 모두 조회, findOne으로 하나만 조회

## Read(조건)

- 두 번째 인수로 조회할 필드를 선택할 수 있음(1은 추가, 0은 제외)
- 첫 번째 인수로 조회 조건 ㅇ비력 가능
    - $gt나 $or같은 조건 연산자 사용
    - 정렬을 sort메서드로 함
    - limit 메서드로 조회할 다큐먼트 개수 제한
    - skip 메서드로 건너뛸 다큐먼트 개수 제공

## Update

- update 메서드로 쿼리
    - 첫 번째 인수로 수정 대상을, 두 번째 인수로 수정 내용을 제공
    - $set을 붙이지 않으면 다큐먼트 전체가 대체되므로 주의
    - 결과로 수정된 개수가 나옴

## Delete

- remove메서드로 쿼리
    - 첫 번째 인수로 삭제할 대상 조건 제공
    - 성공 시 삭제된 개수가 반환됨

# 몽구스 사용하기

## 몽구스 ODM

- 몽고디비 작업을 쉽게 할 수 있도록 도와주는 라이브러리
    - ODM: Object Document Mapping: 객체와 다큐먼트를 매핑(1대1 짝지음)
    - 몽고디비에 없어 불편한 기능들을 몽구스가 보완
    - 테이블과 유사한 기능, JOIN 기능 추가